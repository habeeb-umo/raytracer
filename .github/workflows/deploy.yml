# This is a basic workflow that is manually triggered

name: Deploy

on: 
  release:
    types: [released]
    
concurrency: prod-deploy

jobs:
  checkTag:
    runs-on: ubuntu-latest
    outputs:
      is-release-tag: ${{ steps.check-tag.outputs.is-release-tag }}
    steps:
      - name: Check tag
        id: check-tag
        run: |
          if [[ ${{ github.ref }} =~ refs\/tags\/v[0-9]{4}\.[0-9]{2}\.[0-9]{2}\..{7}$ ]]; then
            echo "::set-output name=is-release-tag::true"
          else
            echo "::set-output name=is-release-tag::false"
          fi


  greet:
    needs: [checkTag]
    if: needs.checkTag.outputs.is-release-tag == 'true'
    
    runs-on: ubuntu-latest
    steps:
    - name: Send greeting
      run: echo "Hello ${{ github.event.inputs.name }}"
